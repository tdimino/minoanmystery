---
import { ViewTransitions } from 'astro:transitions';
import { Icon } from 'astro-icon/components';
import Lightbox from '../components/Lightbox.astro';
import '../styles/global.css';
import '../styles/resume.css';

const title = "Resume - Tom di Mino";
const description = "Applied AI/ML Engineer with 4+ years shipping LLM-powered production systems. Built $800k/day AI tool at JP Morgan serving 5,000+ wealth advisors. Currently architecting production AI platform at Subquadratic AI with fine-tuned LLMs and voice pipelines.";
const canonicalURL = "https://resume.minoanmystery.org";

// Structured Data for Resume/ProfilePage
const structuredData = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "ProfilePage",
      "@id": `${canonicalURL}/#profilepage`,
      "mainEntity": {
        "@id": `${canonicalURL}/#person`
      },
      "dateCreated": "2025-01-27",
      "dateModified": new Date().toISOString().split('T')[0]
    },
    {
      "@type": "Person",
      "@id": `${canonicalURL}/#person`,
      "name": "Tom di Mino",
      "url": "https://www.minoanmystery.org",
      "image": "https://www.minoanmystery.org/images/tyrian-profile.png",
      "jobTitle": "Principal AI/ML Engineer",
      "description": description,
      "email": "contact@tomdimino.com",
      "sameAs": [
        "https://www.linkedin.com/in/tomdimino/",
        "https://github.com/tdimino",
        "https://www.minoanmystery.org"
      ],
      "worksFor": {
        "@type": "Organization",
        "name": "Subquadratic AI",
        "url": "https://aldea.ai"
      },
      "alumniOf": {
        "@type": "CollegeOrUniversity",
        "name": "The College of New Jersey"
      },
      "knowsAbout": [
        "AI/ML Engineering",
        "Large Language Models",
        "LLM Fine-tuning",
        "RAG Systems",
        "Vector Databases",
        "LangGraph",
        "LlamaIndex",
        "Python",
        "TypeScript",
        "TensorRT-LLM",
        "Triton Inference Server",
        "Voice AI Pipelines"
      ],
      "hasCredential": [
        {
          "@type": "EducationalOccupationalCredential",
          "name": "Google Prompting Essentials"
        },
        {
          "@type": "EducationalOccupationalCredential",
          "name": "Introduction to Large Language Models"
        },
        {
          "@type": "EducationalOccupationalCredential",
          "name": "Introduction to Generative AI"
        }
      ]
    }
  ]
};

// Data
const skills = [
  {
    title: "AI/ML",
    icon: "ph:brain-duotone",
    items: "LLM APIs (OpenAI, Anthropic, Groq), LangGraph, LlamaIndex, DeepEval, Fine-tuning (LoRA), Embeddings (VoyageAI), Vector DBs (pgvector), Semantic search, Subquadratic attention"
  },
  {
    title: "Infrastructure",
    icon: "ph:hard-drives-duotone",
    items: "TensorRT-LLM, Triton Inference Server, Lambda Labs H100, FastAPI, WebSocket, SSE streaming"
  },
  {
    title: "Languages",
    icon: "ph:code-duotone",
    items: "Python, TypeScript, JavaScript, C"
  },
  {
    title: "Web",
    icon: "ph:globe-duotone",
    items: "Next.js, React, Node.js, Astro, Vite, Tailwind, ShadCN, LiveKit, Vercel, Railway"
  }
];

const experience = [
  {
    company: "Subquadratic AI",
    role: "Principal AI/ML Engineer",
    dates: "Jul 2025 — Present",
    context: "Startup building AI advisors that internalize expert methodologies via fine-tuned and post-Transformer LLMs",
    logo: "/images/logos/aldea.png",
    logoUrl: "https://aldea.ai",
    logoDark: true, // needs inversion in dark mode
    bullets: [
      { text: "Architected production SMS/mobile AI platform with <strong>9 cognitive agent \"souls\"</strong> and layered memory" },
      { text: "Deployed <strong>fine-tuned LLMs</strong> to production via TensorRT-LLM + Triton on <span class=\"metric\">4×H100</span> with tensor parallelism" },
      { text: "Built LLM-as-a-Judge evaluation framework using Gemini, Qwen3, Kimi K2 for <strong>9-dimensional persona assessment</strong>" },
      { text: "Implemented voice-first pipeline with <strong>sub-second latency</strong>, barge-in detection, and speculative RAG" },
      { text: "Designed cognitive flows for AI advisors that remember across sessions and emotionally attune" },
      { text: "Maintained internal <strong>Claude Code</strong> skills repo and mentored teams on agentic planning, debugging, and development" }
    ]
  },
  {
    company: "JP Morgan Chase",
    role: "AI Content Engineer",
    dates: "May 2024 — Jul 2025",
    context: "World's largest bank, building AI tools for 5,000+ wealth advisors",
    logo: "/images/logos/jpmorgan.png",
    logoUrl: "https://www.jpmorgan.com",
    logoDark: false,
    bullets: [
      { text: "Built \"Meeting Assist\" AI tool generating <span class=\"metric\">$800k/day</span> savings with <span class=\"metric\">72%</span> adoption rate" },
      { text: "Designed <strong>5-agent agentic architecture</strong> using LangGraph, evaluated with DeepEval" },
      { text: "Reduced hallucinations in production by <strong>rewriting prompts</strong> and deconstructing chain-of-thought" },
      { text: "Developed RAG pipelines using <strong>LlamaIndex</strong> and proprietary solutions" }
    ]
  },
  {
    company: "Google",
    role: "Sr. Content Designer / AI UX Copywriter",
    dates: "Jun 2022 — May 2024",
    context: "Worked with AI UX, RAI, and DeepMind teams",
    logo: "/images/logos/google.png",
    logoUrl: "https://www.google.com",
    logoDark: false,
    bullets: [
      { text: "Designed curriculum for Googlers advancing technical leadership skills (Markdown, HTML/CSS)" },
      { text: "Interviewed AI/UX leaders and synthesized learnings into internal/external thought leadership" },
      { text: "Audited mentorship platform serving <span class=\"metric\">22k+</span> employees, drove <span class=\"metric\">25%</span> rise in program launches" }
    ]
  },
  {
    company: "Chan Zuckerberg Initiative",
    role: "Sr. Content Designer",
    dates: "Nov 2021 — Jun 2022",
    context: "Building open-source scientific tools for image analysis",
    logo: "/images/logos/czi.svg",
    logoUrl: "https://chanzuckerberg.com",
    logoDark: false,
    bullets: [
      { text: "Co-led design of learning platform for <strong>napari</strong>—Python-based image analysis for biologists" },
      { text: "Published full course on GitHub using <strong>Jupyter Book, Jupyter Notebooks</strong> (Markdown, Python, and narrated video)" },
      { text: "Collaborated with 9 application scientists, UX researchers, and SWEs to ship MVP in 6 months" }
    ]
  }
];

const projects = [
  {
    name: "Claude Code Starter-Kit",
    year: "2026",
    description: "Open-source <code>~/.claude/</code> configuration—40 skills, 30+ slash commands, 7 lifecycle hooks, CLI tools, and a VS Code extension. Covers local ML, RAG, browser automation, academic research, agentic teams, and session tracking. <br><a href='https://github.com/tdimino/claude-code-minoan' class='project-link' target='_blank'>View on GitHub →</a>",
    tech: ["Claude Code", "Python", "TypeScript", "Bash"],
    icon: "ph:terminal-window-duotone",
    logo: "/images/seal-of-minos.png",
    logoUrl: "https://github.com/tdimino/claude-code-minoan",
    logoDark: true,
    logoCircular: true
  },
  {
    name: "Claudicle",
    year: "2026",
    description: "Open-source alternative to OpenClaw with four-layer soul architecture (<code>soul.md</code>, Cognition, Memory, Channels)—configurable personas, cognitive pipelines, and Slack integration. Built for augmenting Claude Code sessions. <br><a href='https://github.com/tdimino/claudicle' class='project-link' target='_blank'>View on GitHub →</a>",
    tech: ["Python", "Claude Agent SDK", "Slack SDK", "SQLite"],
    icon: "ph:brain-duotone",
    logo: "/images/claudius-mask.png",
    logoUrl: "https://github.com/tdimino/claudicle",
    logoDark: false,
    logoCircular: true
  },
  {
    name: "BG3 Script Extender macOS",
    year: "2026",
    description: "Open source native ARM64 port of Baldur's Gate 3 Script Extender. Ground-up systems programming—runtime hooking, memory injection, embedded Lua scripting. 94% feature parity with 1,999 components via Ghidra reverse engineering. <br><a href='https://github.com/tdimino/bg3se-macos' class='project-link' target='_blank'>View on GitHub →</a>",
    tech: ["C", "ARM64", "Ghidra", "Lua"],
    icon: "ph:game-controller-duotone",
    logo: "/images/badge-bg3se.png",
    logoUrl: "https://github.com/tdimino/bg3se-macos",
    logoDark: false,
    logoCircular: true
  },
  {
    name: "Kothar wa Khasis",
    year: "2026",
    description: "AI oracle living inside minoanmystery.org—perceives visitor behavior, remembers across sessions, generates tarot cards, and speaks through RAG-enhanced memory. Built on the Open Souls paradigm. Named for the Canaanite craftsman god. <br><a href='https://www.minoanmystery.org/labyrinth' class='project-link' target='_blank'>Speak with Kothar →</a>",
    tech: ["Open Souls", "VoyageAI", "Supabase", "Astro"],
    icon: "ph:eye-duotone",
    logo: "/images/avatars/minoan-avatar.webp",
    logoUrl: "https://www.minoanmystery.org/labyrinth",
    logoDark: false,
    logoCircular: true
  }
];

// Generate lightbox galleries from project data
function stripHtml(html: string): string {
  return html.replace(/<[^>]*>/g, '').replace(/\s+/g, ' ').trim();
}

// Single gallery with all projects — arrows navigate between them
const lightboxGalleries = [{
  id: 'resume-projects',
  trigger: '__match_any_image__',
  images: projects.map(p => ({
    src: p.logo,
    caption: `${p.name} (${p.year})`,
    title: p.name,
    year: p.year,
    description: stripHtml(p.description).replace(/View on GitHub →|Speak with Kothar →/g, '').trim(),
    tags: p.tech,
    invertInLightbox: p.logoDark,
    circular: p.logoCircular,
    link: p.logoUrl ? {
      url: p.logoUrl,
      label: p.logoUrl.includes('github') ? 'View on GitHub' : (p.logoUrl.includes('labyrinth') ? 'Speak with Kothar' : 'Visit')
    } : undefined
  }))
}];
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{title}</title>
  <meta name="description" content={description}>

  <!-- SEO -->
  <link rel="canonical" href={canonicalURL}>
  <meta name="author" content="Tom di Mino">
  <meta name="keywords" content="AI engineer, ML engineer, LLM, machine learning, applied AI, Python, TypeScript, LangGraph, RAG, vector databases, fine-tuning">

  <!-- Open Graph -->
  <meta property="og:type" content="profile">
  <meta property="og:url" content={canonicalURL}>
  <meta property="og:title" content={title}>
  <meta property="og:description" content={description}>
  <meta property="og:image" content="https://www.minoanmystery.org/images/og/og-about.png">
  <meta property="og:site_name" content="Minoan Mystery">
  <meta property="profile:first_name" content="Tom">
  <meta property="profile:last_name" content="di Mino">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content={canonicalURL}>
  <meta name="twitter:title" content={title}>
  <meta name="twitter:description" content={description}>
  <meta name="twitter:image" content="https://www.minoanmystery.org/images/og/og-about.png">

  <!-- Structured Data -->
  <script type="application/ld+json" set:html={JSON.stringify(structuredData)} />

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/favicon.ico">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

  <ViewTransitions />

  <!-- Theme: FOUC prevention (mirrors ThemeScript.astro) -->
  <script is:inline>
    (function() {
      function getTimeBasedTheme() {
        try {
          var now = new Date();
          var hour = now.getHours();
          var tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
          if (!tz || tz === 'UTC') {
            var fmt = new Intl.DateTimeFormat('en-US', {
              timeZone: 'America/New_York', hour: 'numeric', hour12: false
            });
            hour = parseInt(fmt.format(now), 10);
          }
          return (hour >= 7 && hour < 17) ? 'light' : 'dark';
        } catch (e) { return null; }
      }
      var stored = localStorage.getItem('theme');
      var timeBased = getTimeBasedTheme();
      var systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      var theme = stored || timeBased || (systemDark ? 'dark' : 'light');
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>
</head>
<body class="resume-page">
  <!-- Back to site -->
  <a href="/" class="back-link" aria-label="Back to minoanmystery.org" data-animate="fade">
    <Icon name="ph:arrow-left" />
    <span class="back-link-text" aria-hidden="true">minoanmystery.org</span>
  </a>

  <!-- PDF Export -->
  <button class="pdf-export-btn" onclick="window.print()" data-animate="fade">
    <Icon name="ph:file-pdf-duotone" />
    Export PDF
  </button>

  <!-- Theme Toggle -->
  <button class="resume-theme-toggle" aria-label="Toggle theme" title="Toggle theme (Cmd+Shift+D)" data-animate="fade">
    <svg class="theme-icon theme-icon--sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
    <svg class="theme-icon theme-icon--moon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
    </svg>
  </button>

  <div class="resume-container">
    <!-- Header -->
    <header class="resume-header" data-animate="header">
      <h1 class="resume-name">Tom di Mino</h1>
      <p class="resume-title">Applied AI/ML Engineer</p>
      <div class="resume-contact">
        <a href="mailto:contact@tomdimino.com">
          <Icon name="ph:envelope-duotone" class="contact-icon" />
          contact@tomdimino.com
        </a>
        <span class="separator">·</span>
        <a href="https://linkedin.com/in/tomdimino" target="_blank" rel="noopener">
          <Icon name="ph:linkedin-logo-duotone" class="contact-icon" />
          linkedin.com/in/tomdimino
        </a>
        <span class="separator">·</span>
        <a href="https://github.com/tdimino" target="_blank" rel="noopener">
          <Icon name="ph:github-logo-duotone" class="contact-icon" />
          github.com/tdimino
        </a>
        <span class="separator">·</span>
        <span>
          <Icon name="ph:map-pin-duotone" class="contact-icon" />
          Beacon, NY
        </span>
      </div>
    </header>

    <!-- Summary -->
    <div class="resume-summary" data-animate="summary">
      <p>
        Full-stack AI engineer with <strong>4+ years shipping LLM-powered production systems</strong>.
        Built <strong>$800k/day AI tool</strong> at JP Morgan serving 5,000+ wealth advisors.
        Currently architecting production AI advisor platform at SubQ AI with fine-tuned LLMs,
        voice pipelines, and multi-dimensional evaluation frameworks. <strong>Startup builder who moves fast, empathizes, and ideates constantly.</strong>
      </p>
    </div>

    <!-- Two Column Layout -->
    <div class="resume-two-col">
      <!-- Main Column -->
      <div class="resume-main">
        <!-- Work Experience -->
        <section class="resume-section">
          <h2 class="resume-section-title" data-animate="section">
            <Icon name="ph:briefcase-duotone" class="section-icon" />
            Experience
          </h2>

          {experience.map((job, index) => (
            <div class="experience-entry" data-animate="entry" data-delay={index * 100}>
              <div class="experience-header">
                <div class="experience-title-row">
                  {job.logo && job.logoUrl && (
                    <a href={job.logoUrl} target="_blank" rel="noopener" class="logo-link" title={`Visit ${job.company}`}>
                      <img
                        src={job.logo}
                        alt={job.company}
                        class={`experience-logo ${job.logoDark ? 'logo-invert' : ''}`}
                      />
                    </a>
                  )}
                  <div>
                    <h3 class="experience-company">{job.company}</h3>
                    <p class="experience-role">{job.role}</p>
                  </div>
                </div>
                <span class="experience-dates">{job.dates}</span>
              </div>
              <p class="experience-context">{job.context}</p>
              <ul class="experience-bullets">
                {job.bullets.map((bullet) => (
                  <li set:html={bullet.text} />
                ))}
              </ul>
            </div>
          ))}
        </section>
      </div>

      <!-- Sidebar -->
      <aside class="resume-sidebar">
        <!-- Technical Skills -->
        <section class="resume-section">
          <h2 class="resume-section-title" data-animate="section">
            <Icon name="ph:lightning-duotone" class="section-icon" />
            Skills
          </h2>

          {skills.map((skill, index) => (
            <div class="skill-category" data-animate="skill" data-delay={index * 80}>
              <h3 class="skill-category-title">
                <Icon name={skill.icon} class="skill-icon" />
                {skill.title}
              </h3>
              <p class="skill-category-items">{skill.items}</p>
            </div>
          ))}
        </section>

        <!-- Education -->
        <section class="resume-section">
          <h2 class="resume-section-title" data-animate="section">
            <Icon name="ph:graduation-cap-duotone" class="section-icon" />
            Education
          </h2>
          <div class="education-item" data-animate="edu">
            <h3 class="education-title">B.S. Microbiology</h3>
            <p class="education-institution">The College of New Jersey</p>
            <p class="education-details">Minor in Classical History · 2007–2011</p>
          </div>
          <div class="education-item" data-animate="edu">
            <h3 class="education-title">Improv Comedy 101</h3>
            <p class="education-institution">Upright Citizens Brigade Theatre</p>
            <p class="education-details">NYC · 2015</p>
          </div>
        </section>

        <!-- Awards -->
        <section class="resume-section">
          <h2 class="resume-section-title" data-animate="section">
            <Icon name="ph:trophy-duotone" class="section-icon" />
            Awards
          </h2>
          <div class="education-item" data-animate="cert">
            <h3 class="education-title">2nd Place — Fractal Tech NYC Hackathon</h3>
            <p class="education-details">Fractal Tech NYC · Jul 2024</p>
          </div>
          <div class="education-item" data-animate="cert">
            <h3 class="education-title">3rd Place — Betaworks Hackathon</h3>
            <p class="education-details">Betaworks / Open Souls · May 2024</p>
          </div>
        </section>

        <!-- Certifications -->
        <section class="resume-section">
          <h2 class="resume-section-title" data-animate="section">
            <Icon name="ph:certificate-duotone" class="section-icon" />
            Certifications
          </h2>
          <div class="education-item" data-animate="cert">
            <p class="education-institution">
              <Icon name="ph:check-circle-duotone" class="cert-icon" />
              Google Prompting Essentials (2025)
            </p>
            <p class="education-institution">
              <Icon name="ph:check-circle-duotone" class="cert-icon" />
              Introduction to Large Language Models (2023)
            </p>
            <p class="education-institution">
              <Icon name="ph:check-circle-duotone" class="cert-icon" />
              Introduction to Generative AI (2023)
            </p>
          </div>
        </section>
      </aside>
    </div>

    <!-- Page 2: Projects -->
    <div class="page-two-start">
      <section class="resume-section">
        <h2 class="resume-section-title" data-animate="section">
          <Icon name="ph:rocket-launch-duotone" class="section-icon" />
          Notable Projects
        </h2>

        <div class="projects-grid">
          {projects.map((project, index) => (
            <div class="project-card" data-animate="project" data-delay={index * 100}>
              <div class="project-header">
                <div class="project-title-row">
                  {project.logo && (
                    <button
                      class="logo-lightbox-trigger"
                      data-lightbox
                      aria-label={`View ${project.name} logo in lightbox`}
                      title={`View ${project.name} logo`}
                      type="button"
                    >
                      <img
                        src={project.logo}
                        alt={project.name}
                        class={`project-logo ${project.logoDark ? 'logo-invert' : ''} ${project.logoCircular ? 'logo-circular' : ''}`}
                      />
                    </button>
                  )}
                  <h3 class="project-name">{project.name}</h3>
                </div>
                <span class="project-year">{project.year}</span>
              </div>
              <p class="project-description" set:html={project.description} />
              <div class="project-tech">
                {project.tech.map((tech) => (
                  <span class="tech-tag">{tech}</span>
                ))}
              </div>
            </div>
          ))}
        </div>
      </section>
    </div>

    <!-- Footer note -->
    <footer class="resume-footer" data-animate="footer">
      <p>
        <Icon name="ph:link-duotone" class="footer-icon" />
        Interactive version at <a href="https://minoanmystery.org/resume">minoanmystery.org/resume</a>
      </p>
    </footer>
  </div>

  <!-- Motion Animations -->
  <script>
    import { animate, stagger, inView } from 'motion';

    // Track inView cleanups for View Transition teardown
    let inViewCleanups: (() => void)[] = [];

    function initResumeAnimations() {
      // Respect prefers-reduced-motion
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      inViewCleanups = [];

      // Header animation
      const header = document.querySelector('[data-animate="header"]');
      if (header) {
        header.style.opacity = '0';
        header.style.transform = 'translateY(-20px)';
        animate(header, {
          opacity: 1,
          transform: 'translateY(0)'
        }, {
          duration: 0.6,
          easing: [0.25, 0.46, 0.45, 0.94],
          delay: 0.1
        });
      }

      // Summary animation
      const summary = document.querySelector('[data-animate="summary"]');
      if (summary) {
        summary.style.opacity = '0';
        summary.style.transform = 'translateX(-20px)';
        animate(summary, {
          opacity: 1,
          transform: 'translateX(0)'
        }, {
          duration: 0.5,
          easing: [0.25, 0.46, 0.45, 0.94],
          delay: 0.3
        });
      }

      // Section titles
      document.querySelectorAll('[data-animate="section"]').forEach((el, i) => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(10px)';
        animate(el, {
          opacity: 1,
          transform: 'translateY(0)'
        }, {
          duration: 0.4,
          easing: [0.25, 0.46, 0.45, 0.94],
          delay: 0.4 + (i * 0.1)
        });
      });

      // Experience entries - animate on scroll
      document.querySelectorAll('[data-animate="entry"]').forEach((el) => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';

        const cleanup = inView(el, () => {
          const delay = parseInt(el.dataset.delay || '0') / 1000;
          animate(el, {
            opacity: 1,
            transform: 'translateY(0)'
          }, {
            duration: 0.5,
            easing: [0.25, 0.46, 0.45, 0.94],
            delay
          });
        }, { margin: '-50px 0px' });
        inViewCleanups.push(cleanup);
      });

      // Skill cards - staggered animation
      const skillCards = document.querySelectorAll('[data-animate="skill"]');
      skillCards.forEach((el) => {
        el.style.opacity = '0';
        el.style.transform = 'translateX(20px)';
      });

      if (skillCards.length > 0) {
        animate(skillCards, {
          opacity: 1,
          transform: 'translateX(0)'
        }, {
          duration: 0.4,
          easing: [0.25, 0.46, 0.45, 0.94],
          delay: stagger(0.08, { start: 0.5 })
        });
      }

      // Project cards - animate on scroll
      document.querySelectorAll('[data-animate="project"]').forEach((el) => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px) scale(0.98)';

        const cleanup = inView(el, () => {
          const delay = parseInt(el.dataset.delay || '0') / 1000;
          animate(el, {
            opacity: 1,
            transform: 'translateY(0) scale(1)'
          }, {
            duration: 0.5,
            easing: [0.25, 0.46, 0.45, 0.94],
            delay
          });
        }, { margin: '-100px 0px' });
        inViewCleanups.push(cleanup);
      });

      // Education & certs - staggered animation
      const eduCertEls = document.querySelectorAll('[data-animate="edu"], [data-animate="cert"]');
      eduCertEls.forEach((el) => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(15px)';
      });
      if (eduCertEls.length > 0) {
        animate(eduCertEls, {
          opacity: 1,
          transform: 'translateY(0)'
        }, {
          duration: 0.4,
          easing: [0.25, 0.46, 0.45, 0.94],
          delay: stagger(0.1, { start: 0.7 })
        });
      }

      // Fade elements - staggered animation
      const fadeEls = document.querySelectorAll('[data-animate="fade"]');
      fadeEls.forEach((el) => {
        el.style.opacity = '0';
      });
      if (fadeEls.length > 0) {
        animate(fadeEls, {
          opacity: 1
        }, {
          duration: 0.4,
          delay: stagger(0.1, { start: 0.8 })
        });
      }

      // Footer
      const footer = document.querySelector('[data-animate="footer"]');
      if (footer) {
        footer.style.opacity = '0';
        const cleanup = inView(footer, () => {
          animate(footer, {
            opacity: 1
          }, {
            duration: 0.5,
            delay: 0.2
          });
        });
        inViewCleanups.push(cleanup);
      }
    }

    // Theme toggle
    function initThemeToggle() {
      const themeBtn = document.querySelector('.resume-theme-toggle');
      if (!themeBtn) return;

      themeBtn.addEventListener('click', () => {
        const current = document.documentElement.getAttribute('data-theme') || 'light';
        const next = current === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
      });
    }

    // Keyboard shortcut: Cmd+Shift+D
    function handleThemeKeydown(e: KeyboardEvent) {
      if ((e.metaKey || e.ctrlKey) && e.shiftKey && e.key.toLowerCase() === 'd') {
        e.preventDefault();
        const themeBtn = document.querySelector('.resume-theme-toggle') as HTMLButtonElement;
        themeBtn?.click();
      }
    }

    document.addEventListener('keydown', handleThemeKeydown);

    // Force light mode for print (ensures all CSS variable cascades resolve correctly)
    window.addEventListener('beforeprint', () => {
      document.documentElement.dataset.printTheme = document.documentElement.getAttribute('data-theme') || 'light';
      document.documentElement.setAttribute('data-theme', 'light');
    });
    window.addEventListener('afterprint', () => {
      const original = document.documentElement.dataset.printTheme;
      if (original) document.documentElement.setAttribute('data-theme', original);
    });

    // Run on load
    document.addEventListener('DOMContentLoaded', () => {
      initResumeAnimations();
      initThemeToggle();
    });

    // Cleanup inView observers before View Transition swap
    document.addEventListener('astro:before-swap', () => {
      inViewCleanups.forEach(cleanup => cleanup());
      inViewCleanups = [];
    });

    // Re-run after view transitions
    document.addEventListener('astro:after-swap', () => {
      initResumeAnimations();
      initThemeToggle();
    });
  </script>

  <Lightbox galleries={lightboxGalleries} />
</body>
</html>
